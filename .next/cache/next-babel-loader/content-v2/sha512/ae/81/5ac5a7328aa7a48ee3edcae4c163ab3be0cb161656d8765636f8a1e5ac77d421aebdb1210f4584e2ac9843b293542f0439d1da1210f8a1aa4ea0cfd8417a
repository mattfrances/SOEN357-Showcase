{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/matthewfrances/Documents/development/School/Winter2021/SOEN357/twitter-clone/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/matthewfrances/Documents/development/School/Winter2021/SOEN357/twitter-clone/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/matthewfrances/Documents/development/School/Winter2021/SOEN357/twitter-clone/src/components/FollowButton/FollowButton.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport PersonAddIcon from \"@material-ui/icons/PersonAdd\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport UserContext from \"../../context/UserContext\";\nimport firebase from \"../../firebase/init\";\n\nvar FollowButton = function FollowButton(_ref) {\n  _s();\n\n  var userID = _ref.userID;\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useState = useState(false),\n      isFollowing = _useState[0],\n      setIsFollowing = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      connectionDocID = _useState2[0],\n      setFollowingDocID = _useState2[1];\n\n  var startFollowing = function startFollowing() {\n    if (!user) {\n      alert(\"You need to sign in for that\");\n      return;\n    }\n\n    var _firebase$firestore$c = firebase.firestore().collection(\"connections\").add({\n      followerID: user.uid,\n      followeeID: userID\n    }),\n        id = _firebase$firestore$c.id;\n\n    setFollowingDocID(id);\n    setIsFollowing(true);\n  };\n\n  var stopFollowing = function stopFollowing() {\n    if (!user) {\n      alert(\"You need to sign in for that\");\n      return;\n    }\n\n    firebase.firestore().collection(\"connections\").doc(connectionDocID)[\"delete\"]();\n    setIsFollowing(false);\n  };\n\n  useEffect(function () {\n    if (user) {\n      var checkFollowing = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var result;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return firebase.firestore().collection(\"connections\").where(\"followeeID\", \"==\", userID).where(\"followerID\", \"==\", user.uid).get();\n\n                case 2:\n                  result = _context.sent;\n\n                  if (result.size === 1) {\n                    setIsFollowing(true);\n                    setFollowingDocID(result.docs[0].id);\n                  }\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function checkFollowing() {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      checkFollowing();\n    }\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"lg:mr-0 lg:ml-auto bg-primary text-white px-2 py-4  lg:px-8 lg:py-4 rounded-md\",\n      type: \"submit\",\n      onClick: function onClick() {\n        return isFollowing ? stopFollowing() : startFollowing();\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"mx-2\",\n        children: /*#__PURE__*/_jsxDEV(PersonAddIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, _this), isFollowing ? \"Following\" : \"Follow\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(FollowButton, \"V1dshWCYzB5siES+o2zDqGocC2Y=\");\n\n_c = FollowButton;\nexport default FollowButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"FollowButton\");","map":{"version":3,"sources":["/Users/matthewfrances/Documents/development/School/Winter2021/SOEN357/twitter-clone/src/components/FollowButton/FollowButton.jsx"],"names":["PersonAddIcon","React","useContext","useEffect","useState","UserContext","firebase","FollowButton","userID","user","isFollowing","setIsFollowing","connectionDocID","setFollowingDocID","startFollowing","alert","firestore","collection","add","followerID","uid","followeeID","id","stopFollowing","doc","checkFollowing","where","get","result","size","docs"],"mappings":"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","sourcesContent":["import PersonAddIcon from \"@material-ui/icons/PersonAdd\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport UserContext from \"../../context/UserContext\";\nimport firebase from \"../../firebase/init\";\n\nconst FollowButton = ({ userID }) => {\n  const { user } = useContext(UserContext);\n  const [isFollowing, setIsFollowing] = useState(false);\n  const [connectionDocID, setFollowingDocID] = useState(\"\");\n\n  const startFollowing = () => {\n    if (!user) {\n      alert(\"You need to sign in for that\");\n      return;\n    }\n    const { id } = firebase.firestore().collection(\"connections\").add({\n      followerID: user.uid,\n      followeeID: userID,\n    });\n    setFollowingDocID(id);\n    setIsFollowing(true);\n  };\n\n  const stopFollowing = () => {\n    if (!user) {\n      alert(\"You need to sign in for that\");\n      return;\n    }\n    firebase\n      .firestore()\n      .collection(\"connections\")\n      .doc(connectionDocID)\n      .delete();\n    setIsFollowing(false);\n  };\n\n  useEffect(() => {\n    if (user) {\n      async function checkFollowing() {\n        const result = await firebase\n          .firestore()\n          .collection(\"connections\")\n          .where(\"followeeID\", \"==\", userID)\n          .where(\"followerID\", \"==\", user.uid)\n          .get();\n        if (result.size === 1) {\n          setIsFollowing(true);\n          setFollowingDocID(result.docs[0].id);\n        }\n      }\n      checkFollowing();\n    }\n  }, [user]);\n\n  return (\n    <div>\n      <button\n        className=\"lg:mr-0 lg:ml-auto bg-primary text-white px-2 py-4  lg:px-8 lg:py-4 rounded-md\"\n        type=\"submit\"\n        onClick={() => (isFollowing ? stopFollowing() : startFollowing())}>\n        <span className=\"mx-2\">\n          <PersonAddIcon />\n        </span>\n        {isFollowing ? \"Following\" : \"Follow\"}\n      </button>\n    </div>\n  );\n};\n\nexport default FollowButton;\n"]},"metadata":{},"sourceType":"module"}